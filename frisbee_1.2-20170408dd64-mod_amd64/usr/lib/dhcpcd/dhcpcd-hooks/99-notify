#Notify user of interface state changes

display_notice()
{
	export DISPLAY=:0
	export TEXTDOMAIN=dhcpcd_notify
	export OUTPUT_CHARSET=UTF-8
	. gettext.sh
	case "$reason" in
	BOUND|REBOOT|STATIC) #up
msg=$(echo -e "Connection acquired on $interface \nIP address $new_ip_address")
x=+30 y=-5 gtkdialog-splash-frisbee -icon /usr/share/pixmaps/frisbee.png -font 'Sans Bold' -fontsize 9 -bg_gradient true -border false -placement top-right -timeout 6 -bg "#24785F" -fg yellow -text "`eval_gettext "$msg"`" ;;
	CARRIER) #ifup
		ssid="$(wpa_cli -i $interface status 2>/dev/null | grep ^ssid | cut -f 2 -d =)"
		x=+30 y=+70 gtkdialog-splash-frisbee -icon /usr/share/pixmaps/frisbee.png -font 'Sans Bold' -fontsize 9 -bg_gradient true -border false -placement top-right -timeout 4 -bg "#454343" -fg white -text "`eval_gettext \"Requesting IP address for \\\$interface \\\$ssid\"`" &
		 ;;
	RELEASE) #release
		x=+30 y=-5 gtkdialog-splash-frisbee -icon /usr/share/pixmaps/frisbee.png -font 'Sans Bold' -fontsize 9 -bg_gradient true -border false -placement top-right -timeout 4 -bg "#454343" -fg white -text "`eval_gettext \"Releasing \\\$interface\"`" ;;
	NOCARRIER) #down
		x=+30 y=-5 gtkdialog-splash-frisbee -icon /usr/share/pixmaps/frisbee.png -font 'Sans Bold' -fontsize 9 -bg_gradient true -border false -placement top-right -timeout 4 -bg "#454343" -fg white -text "`eval_gettext \"\\\$interface is down\"`" ;;
	IPV4LL|TIMEOUT|FAIL) #timeout
		x=+30 y=-5 gtkdialog-splash-frisbee -icon /usr/share/pixmaps/frisbee.png -font 'Sans Bold' -fontsize 9 -bg_gradient true -border false -placement top-right -timeout 5 -bg red -fg yellow -text "`eval_gettext \"IP address request failed on \\\$interface\"`" ;;
	esac
}


if echo "$reason" | grep -q -E 'BOUND|REBOOT|STATIC|CARRIER|RELEASE|NOCARRIER|IPV4LL|TIMEOUT|FAIL';then
	[ -f /etc/dhcpcd_state_notify ] && display_notice
fi

